# 4 qubits 2 layers
adam_4q_2l = [(1650, 0.3658), (3300, 0.4492), (4950, 0.4984), (6600, 0.4896), (8250, 0.5008), (9900, 0.493), (11550, 0.4932), (13200, 0.5164), (14850, 0.554), (16500, 0.5914), (18150, 0.597), (19800, 0.6422), (21450, 0.6418), (23100, 0.5744), (24750, 0.6582), (26400, 0.6724), (28050, 0.6438), (29700, 0.6262), (31350, 0.5316), (33000, 0.6588), (34650, 0.6754), (36300, 0.6744), (37950, 0.6854), (39600, 0.699), (41250, 0.7016), (42900, 0.6628)]
sgd_4q_2l =  [(1650, 0.3322), (3300, 0.3692), (4950, 0.3894), (6600, 0.4058), (8250, 0.4214), (9900, 0.4294), (11550, 0.5256), (13200, 0.5026), (14850, 0.538), (16500, 0.5246), (18150, 0.5214), (19800, 0.4964), (21450, 0.532), (23100, 0.506), (24750, 0.556), (26400, 0.5174), (28050, 0.5214), (29700, 0.4886), (31350, 0.4864), (33000, 0.4912), (34650, 0.4962), (36300, 0.4924), (37950, 0.5056), (39600, 0.581), (41250, 0.5292), (42900, 0.5132), (44550, 0.571)]
wsbd_adam_4q_2l = [(3300.0, 0.4492), (4200.0, 0.4296), (5100.0, 0.4742), (6000.0, 0.5162), (6900.0, 0.392), (7800.0, 0.4394), (8700.0, 0.5048), (9600.0, 0.538), (10500.0, 0.5354), (11400.0, 0.5228), (12300.0, 0.6086), (13200.0, 0.6772), (14100.0, 0.6874), (15000.0, 0.6528), (15900.0, 0.6732), (16800.0, 0.5228), (17700.0, 0.6636), (18600.0, 0.6556), (19500.0, 0.6818), (20400.0, 0.6866), (21300.0, 0.6758), (22200.0, 0.7044), (23100.0, 0.6782), (24000.0, 0.6972), (24900.0, 0.6942), (25800.0, 0.687)]
wsbd_sgd_4q_2l = [(3300.0, 0.3692), (4200.0, 0.4114), (5100.0, 0.4184), (6000.0, 0.4382), (6900.0, 0.5618), (7800.0, 0.5988), (8700.0, 0.5894), (9600.0, 0.588), (10500.0, 0.5532), (11400.0, 0.528), (12300.0, 0.5142), (13200.0, 0.583), (14100.0, 0.5408), (15000.0, 0.557), (15900.0, 0.5366), (16800.0, 0.5132), (17700.0, 0.512), (18600.0, 0.5026), (19500.0, 0.5036), (20400.0, 0.5118), (21300.0, 0.5098), (22200.0, 0.5092), (23100.0, 0.561), (24000.0, 0.5522), (24900.0, 0.5458), (25800.0, 0.5508)]

# 8 qubits 3 layers
wsbd_adam_8q_3l = [(9700.0, 0.4174), (12600.0, 0.4818), (15500.0, 0.502), (18400.0, 0.5896), (21300.0, 0.512), (24200.0, 0.5374), (27100.0, 0.5698), (30000.0, 0.5872), (32900.0, 0.6126), (35800.0, 0.5986), (38700.0, 0.6238), (41600.0, 0.6004), (44500.0, 0.6312), (47400.0, 0.608), (50300.0, 0.6554), (53200.0, 0.6126), (56100.0, 0.599), (59000.0, 0.6108), (61900.0, 0.599), (64800.0, 0.5868), (67700.0, 0.5986), (70600.0, 0.6208), (73500.0, 0.6144), (76400.0, 0.5918), (79300.0, 0.646), (82200.0, 0.6314), (85100.0, 0.6738), (88000.0, 0.6868), (90900.0, 0.6776), (93800.0, 0.6498), (96700.0, 0.6342), (99600.0, 0.6592), (102500.0, 0.6542), (105400.0, 0.6544), (108300.0, 0.6556), (111200.0, 0.6588), (114100.0, 0.66), (117000.0, 0.6504), (119900.0, 0.651), (122800.0, 0.6492), (125700.0, 0.6576), (128600.0, 0.6602), (131500.0, 0.6518), (134400.0, 0.6458), (137300.0, 0.654), (140200.0, 0.6616), (143100.0, 0.6464), (146000.0, 0.6454), (148900.0, 0.661), (151800.0, 0.6556)]
adam_8q_3l = [(4850, 0.3872), (9700, 0.4174), (14550, 0.5518), (19400, 0.6058), (24250, 0.5868), (29100, 0.5874), (33950, 0.481), (38800, 0.5502), (43650, 0.5394), (48500, 0.525), (53350, 0.5414), (58200, 0.5404), (63050, 0.5358), (67900, 0.5612), (72750, 0.552), (77600, 0.5482), (82450, 0.5738), (87300, 0.6044), (92150, 0.6224), (97000, 0.5838), (101850, 0.5904), (106700, 0.636), (111550, 0.6114), (116400, 0.6014), (121250, 0.6382), (126100, 0.7046), (130950, 0.6286), (135800, 0.6484), (140650, 0.6468), (145500, 0.671)]
adam_8q_3l = [(4850, 0.3872), (9700, 0.4174), (14550, 0.5518), (19400, 0.6058), (24250, 0.5868), (29100, 0.5874), (33950, 0.481), (38800, 0.5502), (43650, 0.5394), (48500, 0.525), (53350, 0.5414), (58200, 0.5404), (63050, 0.5358), (67900, 0.5612), (72750, 0.552), (77600, 0.5482), (82450, 0.5738), (87300, 0.6044), (92150, 0.6224), (97000, 0.5838), (101850, 0.5904), (106700, 0.636), (111550, 0.6114), (116400, 0.6014), (121250, 0.6382), (126100, 0.6846), (130950, 0.6286), (135800, 0.6484), (140650, 0.6468), (145500, 0.671)]
sgd_8q_3l = [(4850, 0.3106), (9700, 0.3194), (14550, 0.3284), (19400, 0.3312), (24250, 0.3358), (29100, 0.341), (33950, 0.3404), (38800, 0.3424), (43650, 0.3448), (48500, 0.3466), (53350, 0.35), (58200, 0.357), (63050, 0.3826), (67900, 0.3964), (72750, 0.437), (77600, 0.4436), (82450, 0.4652), (87300, 0.4714), (92150, 0.4698), (97000, 0.4824), (101850, 0.4858), (106700, 0.4902), (111550, 0.491), (116400, 0.4902), (121250, 0.4902), (126100, 0.4892), (130950, 0.4888), (135800, 0.4884), (140650, 0.4926), (145500, 0.4912), (150350, 0.4902), (155200, 0.4906), (160050, 0.488), (164900, 0.4894), (169750, 0.49), (174600, 0.4888), (179450, 0.49), (184300, 0.4904), (189150, 0.4936), (194000, 0.4934), (198850, 0.4932), (203700, 0.4938), (208550, 0.4934), (213400, 0.4946), (218250, 0.4942), (223100, 0.4964), (227950, 0.494), (232800, 0.4912), (237650, 0.4932), (242500, 0.4952)]
wsbd_sgd_8q_3l = [(9700.0, 0.3194), (12600.0, 0.3294), (15500.0, 0.3344), (18400.0, 0.3382), (21300.0, 0.3378), (24200.0, 0.3382), (27100.0, 0.3408), (30000.0, 0.3424), (32900.0, 0.3434), (35800.0, 0.3492), (38700.0, 0.3732), (41600.0, 0.4258), (44500.0, 0.4452), (47400.0, 0.4588), (50300.0, 0.4706), (53200.0, 0.4748), (56100.0, 0.4774), (59000.0, 0.4772), (61900.0, 0.4802), (64800.0, 0.4786), (67700.0, 0.4752), (70600.0, 0.4772), (73500.0, 0.476), (76400.0, 0.4758), (79300.0, 0.4766), (82200.0, 0.4794), (85100.0, 0.4782), (88000.0, 0.477), (90900.0, 0.476), (93800.0, 0.4774), (96700.0, 0.4802), (99600.0, 0.4814), (102500.0, 0.4852), (105400.0, 0.487), (108300.0, 0.49), (111200.0, 0.4922), (114100.0, 0.4924), (117000.0, 0.4918), (119900.0, 0.4922), (122800.0, 0.4924), (125700.0, 0.4916), (128600.0, 0.495), (131500.0, 0.4978), (134400.0, 0.4984), (137300.0, 0.4988), (140200.0, 0.4988), (143100.0, 0.497), (146000.0, 0.494), (148900.0, 0.4944), (151800.0, 0.4948)]

# 10 qubits 5 layers
adam_10q_5l = [(10050, 0.5482), (20100, 0.6388), (30150, 0.62), (40200, 0.66), (50250, 0.6322), (60300, 0.6264), (70350, 0.5738), (80400, 0.6738), (90450, 0.6862), (100500, 0.702), (110550, 0.7296), (120600, 0.7372), (130650, 0.6936)]
wsbd_adam_10q_5l = [(20100.0, 0.6388), (26200.0, 0.617), (32300.0, 0.6108), (38400.0, 0.5896), (44500.0, 0.63), (50600.0, 0.6652), (56700.0, 0.671), (62800.0, 0.6594), (68900.0, 0.6702), (75000.0, 0.6628), (81100.0, 0.675), (87200.0, 0.6616), (93300.0, 0.712)]
wsbd_adam_10q_5l = [(20100.0, 0.6388), (26200.0, 0.645), (32300.0, 0.65), (38400.0, 0.6366), (44500.0, 0.6508), (50600.0, 0.664), (56700.0, 0.716), (62800.0, 0.7166), (68900.0, 0.7366), (75000.0, 0.7336), (81100.0, 0.7088), (87200.0, 0.7034), (93300.0, 0.7234), (99400.0, 0.7424), (105500.0, 0.7354), (111600.0, 0.7312), (117700.0, 0.7076), (123800.0, 0.716), (129900.0, 0.7062), (136000.0, 0.6962)]
wsbd_sgd_10q_5l = [(20100.0, 0.2904), (26200.0, 0.3054), (32300.0, 0.3262), (38400.0, 0.35), (44500.0, 0.3718), (50600.0, 0.3948), (56700.0, 0.4296), (62800.0, 0.4592), (68900.0, 0.4716), (75000.0, 0.4888), (81100.0, 0.5032), (87200.0, 0.5172), (93300.0, 0.5238)]
sgd_10q_5l = [(10050, 0.2796), (20100, 0.2904), (30150, 0.3094), (40200, 0.3208), (50250, 0.345), (60300, 0.363), (70350, 0.3842), (80400, 0.4086), (90450, 0.4398), (100500, 0.4622), (110550, 0.4798), (120600, 0.4938), (130650, 0.4974)]


import matplotlib.pyplot as plt
fourQ_data = [adam_4q_2l, sgd_4q_2l, wsbd_adam_4q_2l, wsbd_sgd_4q_2l]
eightQ_data = [adam_8q_3l, sgd_8q_3l, wsbd_adam_8q_3l, wsbd_sgd_8q_3l]
tenQ_data = [adam_10q_5l, sgd_10q_5l, wsbd_adam_10q_5l, wsbd_sgd_10q_5l]

labels = ["Adam", "SGD", "WSBD Adam", "WSBD SGD"]
titles = ["4 qubit 2 layers", "8 qubit 3 layers", "10 qubit 5 layers"]

fig, axes = plt.subplots(1, 3, figsize=(12, 4))

for ax, dataset, title in zip(axes, [fourQ_data, eightQ_data, tenQ_data], titles):
    for data, label in zip(dataset, labels):
        x = [fp for fp, acc in data]
        y = [acc for fp, acc in data]
        ax.plot(x, y, label=f'{label} {max(y):.2f}%')
        ax.legend()
    ax.set_title(title)
    ax.set_xlabel("Forward Passes")
    ax.set_ylabel("Accuracy")

#axes[0].legend()  # show legend once in the first plot
plt.tight_layout()
plt.show()