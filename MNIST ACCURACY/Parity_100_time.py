#WSBD ADAM time to reach 100%
wsbd_adam_4q_2l = [(660, 0.486), (1320, 0.486), (1980, 0.486), (2640, 0.514), (3300, 0.514), (3480, 0.514), (3660, 1.0)]
wsbd_adam_8q_3l = [(1940, 0.538), (3880, 0.526), (5820, 0.58), (7760, 0.598), (9700, 0.636), (10280, 0.736), (10860, 0.846), (11440, 0.856), (12020, 0.898), (12600, 0.876), (13180, 1.0)]
wsbd_adam_10q_5l = [(4020, 0.534), (8040, 0.522), (12060, 0.518), (16080, 0.532), (20100, 0.566), (21320, 0.566), (22540, 0.576), (23760, 0.566), (24980, 0.58), (26200, 0.588), (27420, 0.594), (28640, 0.592), (29860, 0.602), (31080, 0.616), (32300, 0.62), (33520, 0.62), (34740, 0.594), (35960, 0.608), (37180, 0.626), (38400, 0.634), (39620, 0.64), (40840, 0.622), (42060, 0.642), (43280, 0.644), (44500, 0.662), (45720, 0.666), (46940, 0.646), (48160, 0.65), (49380, 0.626), (50600, 0.646), (51820, 0.64), (53040, 0.656), (54260, 0.654), (55480, 0.676), (56700, 0.664), (57920, 0.65), (59140, 0.652), (60360, 0.646), (61580, 0.688), (62800, 0.692), (64020, 0.73), (65240, 0.844), (66460, 0.938), (67680, 0.988), (68900, 0.994), (70120, 1.0)]

adam_4q_2l = [(660, 0.486), (1320, 0.486), (1980, 0.486), (2640, 0.514), (3300, 0.514), (3960, 1.0)]
adam_8q_3l = [(1940, 0.538), (3880, 0.526), (5820, 0.58), (7760, 0.598), (9700, 0.636), (11640, 0.836), (13580, 1.0)]  
adam_10q_5l = [(4020, 0.534), (8040, 0.522), (12060, 0.518), (16080, 0.532), (20100, 0.566), (24120, 0.578), (28140, 0.568), (32160, 0.566), (36180, 0.584), (40200, 0.614), (44220, 0.64), (48240, 0.65), (52260, 0.688), (56280, 0.69), (60300, 0.69), (64320, 0.726), (68340, 0.752), (72360, 0.752), (76380, 0.782), (80400, 0.796), (84420, 0.934), (88440, 1.0)]

# NEVER
sgd_4q_2l = [(0, 0.5)] #[(660, 0.0), (1320, 0.0), (1980, 0.0), (2640, 0.514), (3300, 0.514), (3960, 0.514), (4620, 0.514), (5280, 0.514), (5940, 0.514), (6600, 0.0), (7260, 0.0), (7920, 0.0), (8580, 0.0), (9240, 0.0), (9900, 0.0), (10560, 0.0), (11220, 0.0), (11880, 0.0), (12540, 0.0), (13200, 0.0), (13860, 0.0), (14520, 0.0), (15180, 0.514), (15840, 0.514), (16500, 0.514), (17160, 0.514), (17820, 0.514), (18480, 0.514), (19140, 0.514), (19800, 0.514), (20460, 0.514), (21120, 0.514), (21780, 0.514), (22440, 0.514), (23100, 0.514), (23760, 0.514), (24420, 0.514), (25080, 0.514), (25740, 0.514), (26400, 0.514), (27060, 0.514), (27720, 0.514), (28380, 0.514), (29040, 0.514), (29700, 0.514), (30360, 0.514), (31020, 0.514), (31680, 0.514), (32340, 0.514), (33000, 0.514), (33660, 0.514), (34320, 0.514), (34980, 0.514), (35640, 0.514), (36300, 0.514), (36960, 0.514), (37620, 0.514), (38280, 0.514), (38940, 0.514), (39600, 0.514), (40260, 0.514), (40920, 0.514), (41580, 0.514), (42240, 0.514), (42900, 0.514), (43560, 0.514), (44220, 0.514), (44880, 0.514), (45540, 0.514), (46200, 0.514), (46860, 0.514), (47520, 0.514), (48180, 0.514), (48840, 0.514), (49500, 0.514), (50160, 0.514), (50820, 0.514), (51480, 0.514), (52140, 0.514), (52800, 0.514), (53460, 0.514), (54120, 0.514), (54780, 0.514), (55440, 0.514), (56100, 0.514), (56760, 0.514), (57420, 0.514), (58080, 0.514), (58740, 0.514), (59400, 0.514), (60060, 0.514), (60720, 0.514), (61380, 0.514), (62040, 0.514), (62700, 0.514), (63360, 0.514), (64020, 0.514), (64680, 0.514), (65340, 0.514), (66000, 0.514), (66660, 0.514), (67320, 0.514)]
sgd_8q_3l = [(1940, 0.524), (3880, 0.524), (5820, 0.524), (7760, 0.524), (9700, 0.524), (11640, 0.524), (13580, 0.528), (15520, 0.524), (17460, 0.524), (19400, 0.52), (21340, 0.52), (23280, 0.52), (25220, 0.52), (27160, 0.524), (29100, 0.524), (31040, 0.524), (32980, 0.524), (34920, 0.524), (36860, 0.524), (38800, 0.534), (40740, 0.534), (42680, 0.534), (44620, 0.534), (46560, 0.534), (48500, 0.542), (50440, 0.542), (52380, 0.542), (54320, 0.542), (56260, 0.54), (58200, 0.54), (60140, 0.546), (62080, 0.546), (64020, 0.546), (65960, 0.554), (67900, 0.558), (69840, 0.554), (71780, 0.55), (73720, 0.546), (75660, 0.546), (77600, 0.546), (79540, 0.546), (81480, 0.546), (83420, 0.55), (85360, 0.55), (87300, 0.538), (89240, 0.538), (91180, 0.538), (93120, 0.538), (95060, 0.548), (97000, 0.544), (98940, 0.548), (100880, 0.548), (102820, 0.548), (104760, 0.556), (106700, 0.548), (108640, 0.548), (110580, 0.548), (112520, 0.548), (114460, 0.548), (116400, 0.548), (118340, 0.548), (120280, 0.548), (122220, 0.56), (124160, 0.564), (126100, 0.56), (128040, 0.56), (129980, 0.56), (131920, 0.566), (133860, 0.566), (135800, 0.568), (137740, 0.566), (139680, 0.578), (141620, 0.584), (143560, 0.584), (145500, 0.566), (147440, 0.566), (149380, 0.584), (151320, 0.584), (153260, 0.584), (155200, 0.584), (157140, 0.582), (159080, 0.582), (161020, 0.582), (162960, 0.576), (164900, 0.576), (166840, 0.578), (168780, 0.576), (170720, 0.574), (172660, 0.576), (174600, 0.576), (176540, 0.576), (178480, 0.57), (180420, 0.57), (182360, 0.572), (184300, 0.572), (186240, 0.582), (188180, 0.592), (190120, 0.592), (192060, 0.578), (194000, 0.578), (195940, 0.578), (197880, 0.582), (199820, 0.582), (201760, 0.586), (203700, 0.594), (205640, 0.594), (207580, 0.584), (209520, 0.584), (211460, 0.576), (213400, 0.576), (215340, 0.586), (217280, 0.584), (219220, 0.576), (221160, 0.576), (223100, 0.576), (225040, 0.576), (226980, 0.578), (228920, 0.576), (230860, 0.59), (232800, 0.6), (234740, 0.6), (236680, 0.604), (238620, 0.616), (240560, 0.618), (242500, 0.632), (244440, 0.644), (246380, 0.644), (248320, 0.652), (250260, 0.652), (252200, 0.652), (254140, 0.65), (256080, 0.65), (258020, 0.652), (259960, 0.664), (261900, 0.664), (263840, 0.69), (265780, 0.69), (267720, 0.682), (269660, 0.68), (271600, 0.7), (273540, 0.706), (275480, 0.74), (277420, 0.734), (279360, 0.732), (281300, 0.744), (283240, 0.758), (285180, 0.766), (287120, 0.77), (289060, 0.786), (291000, 0.792), (292940, 0.82), (294880, 0.85), (296820, 0.88), (298760, 0.894), (300700, 0.904), (302640, 0.904), (304580, 0.926), (306520, 0.938), (308460, 0.95), (310400, 0.952), (312340, 0.956), (314280, 0.966), (316220, 0.99), (318160, 1.0), (320100, 1.0), (322040, 1.0), (323980, 1.0), (325920, 1.0), (327860, 1.0), (329800, 1.0)]
#NEVER
sgd_10q_5l = [(0, 0.5)]#[(4020, 0.492), (8040, 0.494), (12060, 0.494), (16080, 0.49), (20100, 0.492), (24120, 0.49)]

wsbd_sgd_4q_2l = [(2640, 0.514), (4020, 0.514), (4920, 0.0), (5820, 0.0), (6720, 0.0), (7620, 0.0), (8520, 0.514), (9420, 0.514), (10320, 0.514), (11220, 0.514), (12120, 0.514), (13020, 0.514), (13920, 0.514), (14820, 0.514), (15720, 0.514), (16620, 0.514), (17520, 0.514), (18420, 0.514), (19320, 0.514), (20220, 0.514), (21120, 0.514), (22020, 0.514), (22920, 0.514), (23820, 0.514), (24720, 0.486), (25620, 0.486), (26520, 0.486), (27420, 0.486), (28320, 0.486), (29220, 0.486), (30120, 0.486), (31020, 0.486), (31920, 0.514), (32820, 0.514), (33720, 0.514), (34620, 0.514), (35520, 0.514), (36420, 0.514), (37320, 0.514), (38220, 0.514), (39120, 0.514), (40020, 0.514), (40920, 0.514), (41820, 0.514), (42720, 0.514), (43620, 0.514), (44520, 0.514), (45420, 0.514), (46320, 0.514), (47220, 0.514), (48120, 0.514), (49020, 0.514), (49920, 0.514), (50820, 0.514), (51720, 1.0), (52620, 1.0), (53520, 1.0), (54420, 1.0)] 
wsbd_sgd_8q_3l = [(7760, 0.524), (12020, 0.524), (14920, 0.524), (17820, 0.524), (20720, 0.524), (23620, 0.524), (26520, 0.524), (29420, 0.524), (32320, 0.524), (35220, 0.534), (38120, 0.534), (41020, 0.54), (43920, 0.536), (46820, 0.536), (49720, 0.548), (52620, 0.538), (55520, 0.538), (58420, 0.546), (61320, 0.548), (64220, 0.552), (67120, 0.552), (70020, 0.556), (72920, 0.558), (75820, 0.566), (78720, 0.564), (81620, 0.56), (84520, 0.56), (87420, 0.56), (90320, 0.56), (93220, 0.56), (96120, 0.566), (99020, 0.566), (101920, 0.566), (104820, 0.572), (107720, 0.574), (110620, 0.592), (113520, 0.6), (116420, 0.608), (119320, 0.608), (122220, 0.606), (125120, 0.612), (128020, 0.612), (130920, 0.624), (133820, 0.64), (136720, 0.656), (139620, 0.668), (142520, 0.706), (145420, 0.754), (148320, 0.802), (151220, 0.814), (154120, 0.824), (157020, 0.856), (159920, 0.928), (162820, 1.0), (165720, 1.0)]
wsbd_sgd_10q_5l = [(0, 0.5)]

import matplotlib.pyplot as plt
from matplotlib.ticker import MaxNLocator


fourQ_data = [adam_4q_2l, wsbd_adam_4q_2l, sgd_4q_2l, wsbd_sgd_4q_2l]
eightQ_data = [adam_8q_3l, wsbd_adam_8q_3l, sgd_8q_3l, wsbd_sgd_8q_3l]
tenQ_data = [adam_10q_5l, wsbd_adam_10q_5l, sgd_10q_5l, wsbd_sgd_10q_5l]

labels = ["Adam", "WSBD Adam", "SGD", "WSBD SGD"]
colors = ['red', 'green', 'blue', 'orange']
titles = ["4 qubit 2 layers", "8 qubit 3 layers", "10 qubit 5 layers"]
linestyles = ['--', '-', '--', '-']


fig, axes = plt.subplots(1, 3, figsize=(12, 4))

for ax, dataset, title in zip(axes, [fourQ_data, eightQ_data, tenQ_data], titles):
    for data, label, color, linestyle in zip(dataset, labels, colors, linestyles):
        x = [fp for fp, acc in data]
        y = [acc for fp, acc in data]
        if len(x) == 1 and len(y) == 1:
            ax.axhline(y=0.5, color='black', linestyle='--', label=f'{label}', linewidth=3)
        else:
            ax.plot(x, y, label=f'{label}', color=color, linewidth=3, linestyle=linestyle)
        ax.legend(loc='lower right') 
    
    ax.set_title(title)
    ax.set_xlabel("Forward Passes",fontsize=12)
    ax.set_ylabel("Accuracy", fontsize=12)
    ax.set_ylim(0, 1)

    # enforce 5 ticks and integer values
    ax.xaxis.set_major_locator(MaxNLocator(nbins=5, integer=True))
    ax.yaxis.set_major_locator(MaxNLocator(nbins=5, prune=None))  

    # make tick labels larger
    ax.tick_params(axis='both', labelsize=12)


# axes[0].legend()
plt.tight_layout()
plt.show()

for dataset, title in zip([fourQ_data, eightQ_data, tenQ_data], titles):
    for data, label in zip(dataset, labels):
        x = [fp for fp, acc in data]
        y = [acc for fp, acc in data]
        print(f'{title} {label} Max Accuracy: {max(y)*100:.2f}% {x[y.index(max(y))]}FP')