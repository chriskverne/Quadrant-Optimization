import numpy as np

def compute_STD(run_list, label_name):
    """
    Helper function to truncate, calculate stats, and plot a specific group of runs.
    """
    # A. Find min length for this specific group
    min_len = min(len(r) for r in run_list)
    
    # B. Truncate runs to that length to ensure stacking works
    truncated = [np.array(r)[:min_len] for r in run_list]
    
    # C. Stack and Calculate Mean/Std
    data_stack = np.stack(truncated)
    mean_data = np.mean(data_stack, axis=0)
    std_data = np.std(data_stack, axis=0)
    
    print(f'{label_name} Mean STD: {np.mean(std_data)}')


# 4 qubits 2 layers
adam_4q_2l = [(0, 0.25), (1650, 0.3658), (3300, 0.4492), (4950, 0.4984), (6600, 0.4896), (8250, 0.5008), (9900, 0.493), (11550, 0.4932), (13200, 0.5164), (14850, 0.554), (16500, 0.5914), (18150, 0.597), (19800, 0.6422), (21450, 0.6418), (23100, 0.5744), (24750, 0.6582), (26400, 0.6724), (28050, 0.6438), (29700, 0.6262), (31350, 0.5316), (33000, 0.6588), (34650, 0.6754), (36300, 0.6744), (37950, 0.6854), (39600, 0.699), (41250, 0.7016), (42900, 0.6628)]
sgd_4q_2l =  [(0, 0.25),(1650, 0.3322), (3300, 0.3692), (4950, 0.3894), (6600, 0.4058), (8250, 0.4214), (9900, 0.4294), (11550, 0.5256), (13200, 0.5026), (14850, 0.538), (16500, 0.5246), (18150, 0.5214), (19800, 0.4964), (21450, 0.532), (23100, 0.506), (24750, 0.556), (26400, 0.5174), (28050, 0.5214), (29700, 0.4886), (31350, 0.4864), (33000, 0.4912), (34650, 0.4962), (36300, 0.4924), (37950, 0.5056), (39600, 0.581), (41250, 0.5292), (42900, 0.5132), (44550, 0.571)]

wsbd_adam_4q_2l = [(0, 0.25),(3300.0, 0.4492), (4200.0, 0.4296), (5100.0, 0.4742), (6000.0, 0.5162), (6900.0, 0.392), (7800.0, 0.4394), (8700.0, 0.5048), (9600.0, 0.538), (10500.0, 0.5354), (11400.0, 0.5228), (12300.0, 0.6086), (13200.0, 0.6772), (14100.0, 0.6874), (15000.0, 0.6528), (15900.0, 0.6732), (16800.0, 0.5228), (17700.0, 0.6636), (18600.0, 0.6556), (19500.0, 0.6818), (20400.0, 0.6866), (21300.0, 0.6758), (22200.0, 0.7044), (23100.0, 0.6782), (24000.0, 0.6972), (24900.0, 0.6942), (25800.0, 0.687)]
wsbd_adam_4q_2l_r1 = [(0, 0.25),(3300.0, 0.4492), (4200.0, 0.5686), (5100.0, 0.5016), (6000.0, 0.48), (6900.0, 0.4972), (7800.0, 0.5134), (8700.0, 0.5514), (9600.0, 0.5404), (10500.0, 0.5528), (11400.0, 0.6082), (12300.0, 0.5486), (13200.0, 0.5922), (14100.0, 0.5882), (15000.0, 0.6594), (15900.0, 0.684), (16800.0, 0.608), (17700.0, 0.6786), (18600.0, 0.5446), (19500.0, 0.6334), (20400.0, 0.6262), (21300.0, 0.6478), (22200.0, 0.6374), (23100.0, 0.6622), (24000.0, 0.677), (24900.0, 0.6936), (25800.0, 0.6106), (26700.0, 0.6136), (27600.0, 0.587), (28500.0, 0.6472), (29400.0, 0.5678)]
wsbd_adam_4q_2l_r2 = [(0, 0.25),(3300.0, 0.4492), (4200.0, 0.4822), (5100.0, 0.4708), (6000.0, 0.4812), (6900.0, 0.4476), (7800.0, 0.4984), (8700.0, 0.4954), (9600.0, 0.497), (10500.0, 0.4956), (11400.0, 0.4996), (12300.0, 0.5752), (13200.0, 0.5688), (14100.0, 0.5626), (15000.0, 0.579), (15900.0, 0.6856), (16800.0, 0.604), (17700.0, 0.6534), (18600.0, 0.5334), (19500.0, 0.6404), (20400.0, 0.6528), (21300.0, 0.681), (22200.0, 0.688), (23100.0, 0.7006), (24000.0, 0.6996), (24900.0, 0.6728), (25800.0, 0.6054), (26700.0, 0.553), (27600.0, 0.5372), (28500.0, 0.6046), (29400.0, 0.5328)]
wsbd_adam_4q_2l_r3 = [(0, 0.25),(3300.0, 0.4492), (4200.0, 0.5578), (5100.0, 0.5054), (6000.0, 0.5414), (6900.0, 0.4856), (7800.0, 0.4886), (8700.0, 0.6128), (9600.0, 0.545), (10500.0, 0.5486), (11400.0, 0.6678), (12300.0, 0.6396), (13200.0, 0.7026), (14100.0, 0.6544), (15000.0, 0.6468), (15900.0, 0.6426), (16800.0, 0.6588), (17700.0, 0.6416), (18600.0, 0.621), (19500.0, 0.6516), (20400.0, 0.6352), (21300.0, 0.6588), (22200.0, 0.6878), (23100.0, 0.693), (24000.0, 0.696), (24900.0, 0.6848), (25800.0, 0.5492), (26700.0, 0.5754), (27600.0, 0.5324), (28500.0, 0.5794)]

wsbd_adam_4q_2l_runs = [wsbd_adam_4q_2l,wsbd_adam_4q_2l_r1, wsbd_adam_4q_2l_r2, wsbd_adam_4q_2l_r3]
compute_STD(wsbd_adam_4q_2l_runs, "4Q 2L WSBD ADAM")

wsbd_sgd_4q_2l = [(0, 0.25),(3300.0, 0.3692), (4200.0, 0.4114), (5100.0, 0.4184), (6000.0, 0.4382), (6900.0, 0.5618), (7800.0, 0.5988), (8700.0, 0.5894), (9600.0, 0.588), (10500.0, 0.5532), (11400.0, 0.528), (12300.0, 0.5142), (13200.0, 0.583), (14100.0, 0.5408), (15000.0, 0.557), (15900.0, 0.5366), (16800.0, 0.5132), (17700.0, 0.512), (18600.0, 0.5026), (19500.0, 0.5036), (20400.0, 0.5118), (21300.0, 0.5098), (22200.0, 0.5092), (23100.0, 0.561), (24000.0, 0.5522), (24900.0, 0.5458), (25800.0, 0.5508)]
wsbd_sgd_4q_2l_r1 = [(0, 0.25),(3300.0, 0.3692), (4200.0, 0.3856), (5100.0, 0.4068), (6000.0, 0.4368), (6900.0, 0.5176), (7800.0, 0.5504), (8700.0, 0.5972), (9600.0, 0.6008), (10500.0, 0.618), (11400.0, 0.5876), (12300.0, 0.5482), (13200.0, 0.5544), (14100.0, 0.549), (15000.0, 0.563), (15900.0, 0.5438), (16800.0, 0.4996), (17700.0, 0.5032), (18600.0, 0.503), (19500.0, 0.5048), (20400.0, 0.524), (21300.0, 0.5236), (22200.0, 0.603), (23100.0, 0.6668), (24000.0, 0.675), (24900.0, 0.6936), (25800.0, 0.6786)]
wsbd_sgd_4q_2l_r2 = [(0, 0.25),(3300.0, 0.3692), (4200.0, 0.3848), (5100.0, 0.407), (6000.0, 0.5022), (6900.0, 0.5682), (7800.0, 0.536), (8700.0, 0.5568), (9600.0, 0.5762), (10500.0, 0.5768), (11400.0, 0.596), (12300.0, 0.5962), (13200.0, 0.611), (14100.0, 0.5622), (15000.0, 0.5998), (15900.0, 0.575), (16800.0, 0.5574), (17700.0, 0.5712), (18600.0, 0.5762), (19500.0, 0.6072), (20400.0, 0.6096), (21300.0, 0.6354), (22200.0, 0.6564), (23100.0, 0.6748), (24000.0, 0.6752), (24900.0, 0.6748), (25800.0, 0.675)]
wsbd_sgd_4q_2l_r3 = [(0, 0.25),(3300.0, 0.3692), (4200.0, 0.3766), (5100.0, 0.4162), (6000.0, 0.4212), (6900.0, 0.4394), (7800.0, 0.4654), (8700.0, 0.5018), (9600.0, 0.5398), (10500.0, 0.5696), (11400.0, 0.6036), (12300.0, 0.6204), (13200.0, 0.6348), (14100.0, 0.636), (15000.0, 0.6352), (15900.0, 0.634), (16800.0, 0.6332), (17700.0, 0.609), (18600.0, 0.5574), (19500.0, 0.5442), (20400.0, 0.518), (21300.0, 0.4992), (22200.0, 0.5022), (23100.0, 0.502), (24000.0, 0.504), (24900.0, 0.5038), (25800.0, 0.5032)]
wsbd_sgd_4q_2l_r4 = [(0, 0.25),(3300.0, 0.3692), (4200.0, 0.397), (5100.0, 0.4076), (6000.0, 0.4052), (6900.0, 0.4136), (7800.0, 0.4138), (8700.0, 0.4186), (9600.0, 0.425), (10500.0, 0.4438), (11400.0, 0.4618), (12300.0, 0.5094), (13200.0, 0.5576), (14100.0, 0.5016), (15000.0, 0.5372), (15900.0, 0.5486), (16800.0, 0.5304), (17700.0, 0.539), (18600.0, 0.521), (19500.0, 0.524), (20400.0, 0.5108), (21300.0, 0.5066), (22200.0, 0.504), (23100.0, 0.5126), (24000.0, 0.5096), (24900.0, 0.505), (25800.0, 0.503)]

wsbd_sgd_4q_2l_runs = [wsbd_sgd_4q_2l, wsbd_sgd_4q_2l_r1, wsbd_sgd_4q_2l_r2, wsbd_sgd_4q_2l_r3, wsbd_sgd_4q_2l_r4]
compute_STD(wsbd_sgd_4q_2l_runs, "4Q 2L WSBD SGD")

# 8 qubits 3 layers
wsbd_adam_8q_3l = [(0, 0.25),(9700.0, 0.4174), (12600.0, 0.4818), (15500.0, 0.502), (18400.0, 0.5896), (21300.0, 0.512), (24200.0, 0.5374), (27100.0, 0.5698), (30000.0, 0.5872), (32900.0, 0.6126), (35800.0, 0.5986), (38700.0, 0.6238), (41600.0, 0.6004), (44500.0, 0.6312), (47400.0, 0.608), (50300.0, 0.6554), (53200.0, 0.6126), (56100.0, 0.599), (59000.0, 0.6108), (61900.0, 0.599), (64800.0, 0.5868), (67700.0, 0.5986), (70600.0, 0.6208), (73500.0, 0.6144), (76400.0, 0.5918), (79300.0, 0.646), (82200.0, 0.6314), (85100.0, 0.6738), (88000.0, 0.6868), (90900.0, 0.6776), (93800.0, 0.6498), (96700.0, 0.6342), (99600.0, 0.6592), (102500.0, 0.6542), (105400.0, 0.6544), (108300.0, 0.6556), (111200.0, 0.6588), (114100.0, 0.66), (117000.0, 0.6504), (119900.0, 0.651), (122800.0, 0.6492), (125700.0, 0.6576), (128600.0, 0.6602), (131500.0, 0.6518), (134400.0, 0.6458), (137300.0, 0.654), (140200.0, 0.6616), (143100.0, 0.6464), (146000.0, 0.6454), (148900.0, 0.661), (151800.0, 0.6556)]
adam_8q_3l = [(0, 0.25),(4850, 0.3872), (9700, 0.4174), (14550, 0.5518), (19400, 0.6058), (24250, 0.5868), (29100, 0.5874), (33950, 0.481), (38800, 0.5502), (43650, 0.5394), (48500, 0.525), (53350, 0.5414), (58200, 0.5404), (63050, 0.5358), (67900, 0.5612), (72750, 0.552), (77600, 0.5482), (82450, 0.5738), (87300, 0.6044), (92150, 0.6224), (97000, 0.5838), (101850, 0.5904), (106700, 0.636), (111550, 0.6114), (116400, 0.6014), (121250, 0.6382), (126100, 0.7046), (130950, 0.6286), (135800, 0.6484), (140650, 0.6468), (145500, 0.671)]
adam_8q_3l = [(0, 0.25),(4850, 0.3872), (9700, 0.4174), (14550, 0.5518), (19400, 0.6058), (24250, 0.5868), (29100, 0.5874), (33950, 0.481), (38800, 0.5502), (43650, 0.5394), (48500, 0.525), (53350, 0.5414), (58200, 0.5404), (63050, 0.5358), (67900, 0.5612), (72750, 0.552), (77600, 0.5482), (82450, 0.5738), (87300, 0.6044), (92150, 0.6224), (97000, 0.5838), (101850, 0.5904), (106700, 0.636), (111550, 0.6114), (116400, 0.6014), (121250, 0.6382), (126100, 0.6846), (130950, 0.6286), (135800, 0.6484), (140650, 0.6468), (145500, 0.671)]
sgd_8q_3l = [(0, 0.25),(4850, 0.3106), (9700, 0.3194), (14550, 0.3284), (19400, 0.3312), (24250, 0.3358), (29100, 0.341), (33950, 0.3404), (38800, 0.3424), (43650, 0.3448), (48500, 0.3466), (53350, 0.35), (58200, 0.357), (63050, 0.3826), (67900, 0.3964), (72750, 0.437), (77600, 0.4436), (82450, 0.4652), (87300, 0.4714), (92150, 0.4698), (97000, 0.4824), (101850, 0.4858), (106700, 0.4902), (111550, 0.491), (116400, 0.4902), (121250, 0.4902), (126100, 0.4892), (130950, 0.4888), (135800, 0.4884), (140650, 0.4926), (145500, 0.4912), (150350, 0.4902), (155200, 0.4906), (160050, 0.488), (164900, 0.4894), (169750, 0.49), (174600, 0.4888), (179450, 0.49), (184300, 0.4904), (189150, 0.4936), (194000, 0.4934), (198850, 0.4932), (203700, 0.4938), (208550, 0.4934), (213400, 0.4946), (218250, 0.4942), (223100, 0.4964), (227950, 0.494), (232800, 0.4912), (237650, 0.4932), (242500, 0.4952)]
wsbd_sgd_8q_3l = [(0, 0.25),(9700.0, 0.3194), (12600.0, 0.3294), (15500.0, 0.3344), (18400.0, 0.3382), (21300.0, 0.3378), (24200.0, 0.3382), (27100.0, 0.3408), (30000.0, 0.3424), (32900.0, 0.3434), (35800.0, 0.3492), (38700.0, 0.3732), (41600.0, 0.4258), (44500.0, 0.4452), (47400.0, 0.4588), (50300.0, 0.4706), (53200.0, 0.4748), (56100.0, 0.4774), (59000.0, 0.4772), (61900.0, 0.4802), (64800.0, 0.4786), (67700.0, 0.4752), (70600.0, 0.4772), (73500.0, 0.476), (76400.0, 0.4758), (79300.0, 0.4766), (82200.0, 0.4794), (85100.0, 0.4782), (88000.0, 0.477), (90900.0, 0.476), (93800.0, 0.4774), (96700.0, 0.4802), (99600.0, 0.4814), (102500.0, 0.4852), (105400.0, 0.487), (108300.0, 0.49), (111200.0, 0.4922), (114100.0, 0.4924), (117000.0, 0.4918), (119900.0, 0.4922), (122800.0, 0.4924), (125700.0, 0.4916), (128600.0, 0.495), (131500.0, 0.4978), (134400.0, 0.4984), (137300.0, 0.4988), (140200.0, 0.4988), (143100.0, 0.497), (146000.0, 0.494), (148900.0, 0.4944), (151800.0, 0.4948)]

# 10 qubits 5 layers
adam_10q_5l = [(0, 0.25),(10050, 0.5482), (20100, 0.6388), (30150, 0.62), (40200, 0.66), (50250, 0.6322), (60300, 0.6264), (70350, 0.5738), (80400, 0.6738), (90450, 0.6862), (100500, 0.702), (110550, 0.7296), (120600, 0.7372), (130650, 0.6936)]
#adam_10q_5l=[(10050, 0.5494), (20100, 0.5848), (30150, 0.579), (40200, 0.6028), (50250, 0.6394), (60300, 0.5938), (70350, 0.6156), (80400, 0.5486), (90450, 0.56), (100500, 0.559), (110550, 0.5616), (120600, 0.5808), (130650, 0.5846), (140700, 0.6022), (150750, 0.6128), (160800, 0.6262), (170850, 0.614), (180900, 0.6134), (190950, 0.6248), (201000, 0.6194), (211050, 0.6102), (221100, 0.615), (231150, 0.6136), (241200, 0.6234), (251250, 0.6444), (261300, 0.6486), (271350, 0.6298), (281400, 0.6348), (291450, 0.6332), (301500, 0.6718), (311550, 0.6586), (321600, 0.6528), (331650, 0.6798), (341700, 0.6866), (351750, 0.7268), (361800, 0.6958), (371850, 0.738), (381900, 0.7186), (391950, 0.7356), (402000, 0.7192), (412050, 0.7388), (422100, 0.6676), (432150, 0.7336), (442200, 0.7626), (452250, 0.7632), (462300, 0.7606), (472350, 0.7382), (482400, 0.7328), (492450, 0.7018), (502500, 0.7726)]
wsbd_adam_10q_5l = [(0, 0.25),(20100.0, 0.6388), (26200.0, 0.617), (32300.0, 0.6108), (38400.0, 0.5896), (44500.0, 0.63), (50600.0, 0.6652), (56700.0, 0.671), (62800.0, 0.6594), (68900.0, 0.6702), (75000.0, 0.6628), (81100.0, 0.675), (87200.0, 0.6616), (93300.0, 0.712)]
wsbd_adam_10q_5l = [(0, 0.25),(20100.0, 0.6388), (26200.0, 0.645), (32300.0, 0.65), (38400.0, 0.6366), (44500.0, 0.6508), (50600.0, 0.664), (56700.0, 0.716), (62800.0, 0.7166), (68900.0, 0.7366), (75000.0, 0.7336), (81100.0, 0.7088), (87200.0, 0.7034), (93300.0, 0.7234), (99400.0, 0.7424), (105500.0, 0.7354), (111600.0, 0.7312), (117700.0, 0.7076), (123800.0, 0.716), (129900.0, 0.7062), (136000.0, 0.6962)]
#wsbd_adam_10q_5l = [(20100.0, 0.5848), (26200.0, 0.5914), (32300.0, 0.6146), (38400.0, 0.6492), (44500.0, 0.64), (50600.0, 0.6846), (56700.0, 0.6654), (62800.0, 0.6718), (68900.0, 0.6506), (75000.0, 0.6716), (81100.0, 0.6912), (87200.0, 0.6804), (93300.0, 0.6338), (99400.0, 0.6692), (105500.0, 0.6886), (111600.0, 0.688), (117700.0, 0.697), (123800.0, 0.6816), (129900.0, 0.6948), (136000.0, 0.6586), (142100.0, 0.6192), (148200.0, 0.6744), (154300.0, 0.654), (160400.0, 0.6354), (166500.0, 0.6496), (172600.0, 0.6414), (178700.0, 0.6538), (184800.0, 0.6642), (190900.0, 0.6814), (197000.0, 0.6726), (203100.0, 0.7556), (209200.0, 0.7074), (215300.0, 0.726), (221400.0, 0.6958), (227500.0, 0.7512), (233600.0, 0.753), (239700.0, 0.7562), (245800.0, 0.7664), (251900.0, 0.7244), (258000.0, 0.7468), (264100.0, 0.7392), (270200.0, 0.7766), (276300.0, 0.7774), (282400.0, 0.7826), (288500.0, 0.7806), (294600.0, 0.767), (300700.0, 0.7694), (306800.0, 0.6748), (312900.0, 0.729), (319000.0, 0.7266)]
wsbd_sgd_10q_5l = [(0, 0.25),(20100.0, 0.2904), (26200.0, 0.3054), (32300.0, 0.3262), (38400.0, 0.35), (44500.0, 0.3718), (50600.0, 0.3948), (56700.0, 0.4296), (62800.0, 0.4592), (68900.0, 0.4716), (75000.0, 0.4888), (81100.0, 0.5032), (87200.0, 0.5172), (93300.0, 0.5238)]
wsbd_sgd_10q_5l = [(0, 0.25),(20100.0, 0.2904), (26200.0, 0.3062), (32300.0, 0.3296), (38400.0, 0.351), (44500.0, 0.3714), (50600.0, 0.3932), (56700.0, 0.4252), (62800.0, 0.4524), (68900.0, 0.4714), (75000.0, 0.4744), (81100.0, 0.4848), (87200.0, 0.505), (93300.0, 0.518), (99400.0, 0.5302), (105500.0, 0.5384), (111600.0, 0.5412), (117700.0, 0.5472), (123800.0, 0.5518), (129900.0, 0.5512), (136000.0, 0.555), (142100.0, 0.5594), (148200.0, 0.5632), (154300.0, 0.5652), (160400.0, 0.566), (166500.0, 0.5648), (172600.0, 0.5676), (178700.0, 0.5698), (184800.0, 0.5754)]
sgd_10q_5l = [(0, 0.25),(10050, 0.2796), (20100, 0.2904), (30150, 0.3094), (40200, 0.3208), (50250, 0.345), (60300, 0.363), (70350, 0.3842), (80400, 0.4086), (90450, 0.4398), (100500, 0.4622), (110550, 0.4798), (120600, 0.4938), (130650, 0.4974)]
sgd_10q_5l = [(0, 0.25),(10050, 0.2796), (20100, 0.2904), (30150, 0.3094), (40200, 0.3208), (50250, 0.345), (60300, 0.363), (70350, 0.3842), (80400, 0.4086), (90450, 0.4398), (100500, 0.4622), (110550, 0.4798), (120600, 0.4938), (130650, 0.4974), (140700, 0.5116), (150750, 0.5162), (160800, 0.52), (170850, 0.5266), (180900, 0.5366), (190950, 0.543), (201000, 0.5476), (211050, 0.551), (221100, 0.5566), (231150, 0.557), (241200, 0.553), (251250, 0.5562), (261300, 0.5656), (271350, 0.5624), (281400, 0.5624), (291450, 0.5616)]

import matplotlib.pyplot as plt
from matplotlib.ticker import MaxNLocator

fourQ_data = [adam_4q_2l, sgd_4q_2l, wsbd_adam_4q_2l, wsbd_sgd_4q_2l]
eightQ_data = [adam_8q_3l, sgd_8q_3l, wsbd_adam_8q_3l, wsbd_sgd_8q_3l]
tenQ_data = [adam_10q_5l, sgd_10q_5l, wsbd_adam_10q_5l, wsbd_sgd_10q_5l]

labels = ["Adam", "SGD", "WSBD Adam", "WSBD SGD"]
titles = ["4 qubit 2 layers", "8 qubit 3 layers", "10 qubit 5 layers"]
linestyles = ['--', '--', '-', '-']
colors = ['green', 'blue', 'red', 'orange']

fig, axes = plt.subplots(1, 3, figsize=(12, 4))
for ax in axes.ravel():
    ax.set_facecolor("#e2ddddaf")
for ax, dataset, title in zip(axes, [fourQ_data, eightQ_data, tenQ_data], titles):
    for data, label, color, linestyle in zip(dataset, labels, colors, linestyles):
        x = [fp for fp, acc in data]
        y = [acc for fp, acc in data]

        # find index of max accuracy
        max_idx = y.index(max(y))

        # trim x and y up to that point (inclusive)
        x_trimmed = x[:max_idx+1]
        y_trimmed = y[:max_idx+1]

        ax.plot(x_trimmed, y_trimmed, label=f'{label}', linewidth=3, color=color, linestyle=linestyle)
        ax.legend(
            loc='lower right',
            framealpha=1,
            facecolor='white',
            edgecolor='black'
        )
    ax.xaxis.set_major_locator(MaxNLocator(nbins=5, integer=True))
    ax.yaxis.set_major_locator(MaxNLocator(nbins=5, prune=None)) 
    ax.tick_params(axis='both', labelsize=12)
    ax.set_title(title)
    ax.set_xlabel("Forward Passes", fontsize=12)
    ax.set_ylabel("Accuracy", fontsize=12)

plt.tight_layout()
# plt.show()


# for dataset, title in zip([fourQ_data, eightQ_data, tenQ_data], titles):
#     for data, label in zip(dataset, labels):
#         x = [fp for fp, acc in data]
#         y = [acc for fp, acc in data]
#         print(f'{title} {label} Max Accuracy: {max(y):.4f}% {x[y.index(max(y))]}FP')