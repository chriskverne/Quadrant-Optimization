import numpy as np

def compute_STD(run_list, label_name):
    """
    Helper function to truncate, calculate stats, and plot a specific group of runs.
    """
    # A. Find min length for this specific group
    min_len = min(len(r) for r in run_list)
    
    # B. Truncate runs to that length to ensure stacking works
    truncated = [np.array(r)[:min_len] for r in run_list]
    
    # C. Stack and Calculate Mean/Std
    data_stack = np.stack(truncated)
    mean_data = np.mean(data_stack, axis=0)
    std_data = np.std(data_stack, axis=0)

    # D. Aggregate statistics
    mean_std = np.mean(std_data)
    mean_mean = np.mean(mean_data)

    # E. Coefficient of Variation (CV = std / mean * 100)
    cv = (mean_std / mean_mean) * 100 if mean_mean != 0 else float('inf')

    print(f"{label_name} STD: {mean_std:.4f}, CV: {cv:.5f}%")



# 4 qubits 2 layers
adam_4q_2l = [(0, 0.25), (1650, 0.3658), (3300, 0.4492), (4950, 0.4984), (6600, 0.4896), (8250, 0.5008), (9900, 0.493), (11550, 0.4932), (13200, 0.5164), (14850, 0.554), (16500, 0.5914), (18150, 0.597), (19800, 0.6422), (21450, 0.6418), (23100, 0.5744), (24750, 0.6582), (26400, 0.6724), (28050, 0.6438), (29700, 0.6262), (31350, 0.5316), (33000, 0.6588), (34650, 0.6754), (36300, 0.6744), (37950, 0.6854), (39600, 0.699), (41250, 0.7016), (42900, 0.6628)]
sgd_4q_2l =  [(0, 0.25),(1650, 0.3322), (3300, 0.3692), (4950, 0.3894), (6600, 0.4058), (8250, 0.4214), (9900, 0.4294), (11550, 0.5256), (13200, 0.5026), (14850, 0.538), (16500, 0.5246), (18150, 0.5214), (19800, 0.4964), (21450, 0.532), (23100, 0.506), (24750, 0.556), (26400, 0.5174), (28050, 0.5214), (29700, 0.4886), (31350, 0.4864), (33000, 0.4912), (34650, 0.4962), (36300, 0.4924), (37950, 0.5056), (39600, 0.581), (41250, 0.5292), (42900, 0.5132), (44550, 0.571)]

wsbd_adam_4q_2l = [(0, 0.25),(3300.0, 0.4492), (4200.0, 0.4296), (5100.0, 0.4742), (6000.0, 0.5162), (6900.0, 0.392), (7800.0, 0.4394), (8700.0, 0.5048), (9600.0, 0.538), (10500.0, 0.5354), (11400.0, 0.5228), (12300.0, 0.6086), (13200.0, 0.6772), (14100.0, 0.6874), (15000.0, 0.6528), (15900.0, 0.6732), (16800.0, 0.5228), (17700.0, 0.6636), (18600.0, 0.6556), (19500.0, 0.6818), (20400.0, 0.6866), (21300.0, 0.6758), (22200.0, 0.7044), (23100.0, 0.6782), (24000.0, 0.6972), (24900.0, 0.6942), (25800.0, 0.687)]
wsbd_adam_4q_2l_r1 = [(0, 0.25),(3300.0, 0.4492), (4200.0, 0.5686), (5100.0, 0.5016), (6000.0, 0.48), (6900.0, 0.4972), (7800.0, 0.5134), (8700.0, 0.5514), (9600.0, 0.5404), (10500.0, 0.5528), (11400.0, 0.6082), (12300.0, 0.5486), (13200.0, 0.5922), (14100.0, 0.5882), (15000.0, 0.6594), (15900.0, 0.684), (16800.0, 0.608), (17700.0, 0.6786), (18600.0, 0.5446), (19500.0, 0.6334), (20400.0, 0.6262), (21300.0, 0.6478), (22200.0, 0.6374), (23100.0, 0.6622), (24000.0, 0.677), (24900.0, 0.6936), (25800.0, 0.6106), (26700.0, 0.6136), (27600.0, 0.587), (28500.0, 0.6472), (29400.0, 0.5678)]
wsbd_adam_4q_2l_r2 = [(0, 0.25),(3300.0, 0.4492), (4200.0, 0.4822), (5100.0, 0.4708), (6000.0, 0.4812), (6900.0, 0.4476), (7800.0, 0.4984), (8700.0, 0.4954), (9600.0, 0.497), (10500.0, 0.4956), (11400.0, 0.4996), (12300.0, 0.5752), (13200.0, 0.5688), (14100.0, 0.5626), (15000.0, 0.579), (15900.0, 0.6856), (16800.0, 0.604), (17700.0, 0.6534), (18600.0, 0.5334), (19500.0, 0.6404), (20400.0, 0.6528), (21300.0, 0.681), (22200.0, 0.688), (23100.0, 0.7006), (24000.0, 0.6996), (24900.0, 0.6728), (25800.0, 0.6054), (26700.0, 0.553), (27600.0, 0.5372), (28500.0, 0.6046), (29400.0, 0.5328)]
wsbd_adam_4q_2l_r3 = [(0, 0.25),(3300.0, 0.4492), (4200.0, 0.5578), (5100.0, 0.5054), (6000.0, 0.5414), (6900.0, 0.4856), (7800.0, 0.4886), (8700.0, 0.6128), (9600.0, 0.545), (10500.0, 0.5486), (11400.0, 0.6678), (12300.0, 0.6396), (13200.0, 0.7026), (14100.0, 0.6544), (15000.0, 0.6468), (15900.0, 0.6426), (16800.0, 0.6588), (17700.0, 0.6416), (18600.0, 0.621), (19500.0, 0.6516), (20400.0, 0.6352), (21300.0, 0.6588), (22200.0, 0.6878), (23100.0, 0.693), (24000.0, 0.696), (24900.0, 0.6848), (25800.0, 0.5492), (26700.0, 0.5754), (27600.0, 0.5324), (28500.0, 0.5794)]

wsbd_adam_4q_2l_runs = [wsbd_adam_4q_2l,wsbd_adam_4q_2l_r1, wsbd_adam_4q_2l_r2, wsbd_adam_4q_2l_r3]
compute_STD(wsbd_adam_4q_2l_runs, "4Q 2L WSBD ADAM")

wsbd_sgd_4q_2l = [(0, 0.25),(3300.0, 0.3692), (4200.0, 0.4114), (5100.0, 0.4184), (6000.0, 0.4382), (6900.0, 0.5618), (7800.0, 0.5988), (8700.0, 0.5894), (9600.0, 0.588), (10500.0, 0.5532), (11400.0, 0.528), (12300.0, 0.5142), (13200.0, 0.583), (14100.0, 0.5408), (15000.0, 0.557), (15900.0, 0.5366), (16800.0, 0.5132), (17700.0, 0.512), (18600.0, 0.5026), (19500.0, 0.5036), (20400.0, 0.5118), (21300.0, 0.5098), (22200.0, 0.5092), (23100.0, 0.561), (24000.0, 0.5522), (24900.0, 0.5458), (25800.0, 0.5508)]
wsbd_sgd_4q_2l_r1 = [(0, 0.25),(3300.0, 0.3692), (4200.0, 0.3856), (5100.0, 0.4068), (6000.0, 0.4368), (6900.0, 0.5176), (7800.0, 0.5504), (8700.0, 0.5972), (9600.0, 0.6008), (10500.0, 0.618), (11400.0, 0.5876), (12300.0, 0.5482), (13200.0, 0.5544), (14100.0, 0.549), (15000.0, 0.563), (15900.0, 0.5438), (16800.0, 0.4996), (17700.0, 0.5032), (18600.0, 0.503), (19500.0, 0.5048), (20400.0, 0.524), (21300.0, 0.5236), (22200.0, 0.603), (23100.0, 0.6668), (24000.0, 0.675), (24900.0, 0.6936), (25800.0, 0.6786)]
wsbd_sgd_4q_2l_r2 = [(0, 0.25),(3300.0, 0.3692), (4200.0, 0.3848), (5100.0, 0.407), (6000.0, 0.5022), (6900.0, 0.5682), (7800.0, 0.536), (8700.0, 0.5568), (9600.0, 0.5762), (10500.0, 0.5768), (11400.0, 0.596), (12300.0, 0.5962), (13200.0, 0.611), (14100.0, 0.5622), (15000.0, 0.5998), (15900.0, 0.575), (16800.0, 0.5574), (17700.0, 0.5712), (18600.0, 0.5762), (19500.0, 0.6072), (20400.0, 0.6096), (21300.0, 0.6354), (22200.0, 0.6564), (23100.0, 0.6748), (24000.0, 0.6752), (24900.0, 0.6748), (25800.0, 0.675)]
wsbd_sgd_4q_2l_r3 = [(0, 0.25),(3300.0, 0.3692), (4200.0, 0.3766), (5100.0, 0.4162), (6000.0, 0.4212), (6900.0, 0.4394), (7800.0, 0.4654), (8700.0, 0.5018), (9600.0, 0.5398), (10500.0, 0.5696), (11400.0, 0.6036), (12300.0, 0.6204), (13200.0, 0.6348), (14100.0, 0.636), (15000.0, 0.6352), (15900.0, 0.634), (16800.0, 0.6332), (17700.0, 0.609), (18600.0, 0.5574), (19500.0, 0.5442), (20400.0, 0.518), (21300.0, 0.4992), (22200.0, 0.5022), (23100.0, 0.502), (24000.0, 0.504), (24900.0, 0.5038), (25800.0, 0.5032)]
wsbd_sgd_4q_2l_r4 = [(0, 0.25),(3300.0, 0.3692), (4200.0, 0.397), (5100.0, 0.4076), (6000.0, 0.4052), (6900.0, 0.4136), (7800.0, 0.4138), (8700.0, 0.4186), (9600.0, 0.425), (10500.0, 0.4438), (11400.0, 0.4618), (12300.0, 0.5094), (13200.0, 0.5576), (14100.0, 0.5016), (15000.0, 0.5372), (15900.0, 0.5486), (16800.0, 0.5304), (17700.0, 0.539), (18600.0, 0.521), (19500.0, 0.524), (20400.0, 0.5108), (21300.0, 0.5066), (22200.0, 0.504), (23100.0, 0.5126), (24000.0, 0.5096), (24900.0, 0.505), (25800.0, 0.503)]

wsbd_sgd_4q_2l_runs = [wsbd_sgd_4q_2l, wsbd_sgd_4q_2l_r1, wsbd_sgd_4q_2l_r2, wsbd_sgd_4q_2l_r3, wsbd_sgd_4q_2l_r4]
compute_STD(wsbd_sgd_4q_2l_runs, "4Q 2L WSBD SGD")

# 8 qubits 3 layers
wsbd_adam_8q_3l = [(0, 0.25),(9700.0, 0.4174), (12600.0, 0.4818), (15500.0, 0.502), (18400.0, 0.5896), (21300.0, 0.512), (24200.0, 0.5374), (27100.0, 0.5698), (30000.0, 0.5872), (32900.0, 0.6126), (35800.0, 0.5986), (38700.0, 0.6238), (41600.0, 0.6004), (44500.0, 0.6312), (47400.0, 0.608), (50300.0, 0.6554), (53200.0, 0.6126), (56100.0, 0.599), (59000.0, 0.6108), (61900.0, 0.599), (64800.0, 0.5868), (67700.0, 0.5986), (70600.0, 0.6208), (73500.0, 0.6144), (76400.0, 0.5918), (79300.0, 0.646), (82200.0, 0.6314), (85100.0, 0.6738), (88000.0, 0.6868), (90900.0, 0.6776), (93800.0, 0.6498), (96700.0, 0.6342), (99600.0, 0.6592), (102500.0, 0.6542), (105400.0, 0.6544), (108300.0, 0.6556), (111200.0, 0.6588), (114100.0, 0.66), (117000.0, 0.6504), (119900.0, 0.651), (122800.0, 0.6492), (125700.0, 0.6576), (128600.0, 0.6602), (131500.0, 0.6518), (134400.0, 0.6458), (137300.0, 0.654), (140200.0, 0.6616), (143100.0, 0.6464), (146000.0, 0.6454), (148900.0, 0.661), (151800.0, 0.6556)]
wsbd_adam_8q_3l_r1 = [(0, 0.25), (9700.0, 0.4174), (12600.0, 0.5426), (15500.0, 0.5088), (18400.0, 0.5128), (21300.0, 0.483), (24200.0, 0.5026), (27100.0, 0.5242), (30000.0, 0.5054), (32900.0, 0.565), (35800.0, 0.548), (38700.0, 0.5628), (41600.0, 0.532), (44500.0, 0.5688), (47400.0, 0.5438), (50300.0, 0.5318), (53200.0, 0.5528), (56100.0, 0.5054), (59000.0, 0.5404), (61900.0, 0.5664), (64800.0, 0.6016), (67700.0, 0.6022), (70600.0, 0.6038), (73500.0, 0.6038), (76400.0, 0.6006), (79300.0, 0.617), (82200.0, 0.6142), (85100.0, 0.6226), (88000.0, 0.625), (90900.0, 0.6156), (93800.0, 0.6204), (96700.0, 0.596), (99600.0, 0.6016), (102500.0, 0.6078), (105400.0, 0.6074), (108300.0, 0.5984), (111200.0, 0.6324), (114100.0, 0.6246), (117000.0, 0.6238), (119900.0, 0.6092), (122800.0, 0.6156), (125700.0, 0.6406), (128600.0, 0.628), (131500.0, 0.649), (134400.0, 0.6392), (137300.0, 0.6356), (140200.0, 0.6404), (143100.0, 0.6384), (146000.0, 0.637), (148900.0, 0.6332), (151800.0, 0.628)]
wsbd_adam_8q_3l_r2 = [(0, 0.25), (9700.0, 0.4174), (12600.0, 0.4818), (15500.0, 0.5662), (18400.0, 0.472), (21300.0, 0.5), (24200.0, 0.509), (27100.0, 0.5324), (30000.0, 0.5634), (32900.0, 0.6058), (35800.0, 0.5812), (38700.0, 0.596), (41600.0, 0.5788), (44500.0, 0.6424), (47400.0, 0.5932), (50300.0, 0.6096), (53200.0, 0.612), (56100.0, 0.6488), (59000.0, 0.651), (61900.0, 0.647), (64800.0, 0.6582), (67700.0, 0.6432), (70600.0, 0.6494), (73500.0, 0.657), (76400.0, 0.6076), (79300.0, 0.6378), (82200.0, 0.6334), (85100.0, 0.6432), (88000.0, 0.6612), (90900.0, 0.6416), (93800.0, 0.6382), (96700.0, 0.564), (99600.0, 0.6292), (102500.0, 0.627), (105400.0, 0.6078), (108300.0, 0.6272), (111200.0, 0.6438), (114100.0, 0.6598), (117000.0, 0.6182), (119900.0, 0.664), (122800.0, 0.6226), (125700.0, 0.6434), (128600.0, 0.6206), (131500.0, 0.6308), (134400.0, 0.6434), (137300.0, 0.6492), (140200.0, 0.6424), (143100.0, 0.6516), (146000.0, 0.6406), (148900.0, 0.6594), (151800.0, 0.6528)]
wsbd_adam_8q_3l_r3 = [(0, 0.25),(9700.0, 0.4174), (12600.0, 0.4632), (15500.0, 0.5386), (18400.0, 0.5598), (21300.0, 0.5604), (24200.0, 0.5708), (27100.0, 0.5616), (30000.0, 0.6302), (32900.0, 0.6356), (35800.0, 0.6432), (38700.0, 0.616), (41600.0, 0.6424), (44500.0, 0.6554), (47400.0, 0.6486), (50300.0, 0.6612), (53200.0, 0.6566), (56100.0, 0.669), (59000.0, 0.6954), (61900.0, 0.627), (64800.0, 0.6378), (67700.0, 0.558), (70600.0, 0.5722), (73500.0, 0.648), (76400.0, 0.6262), (79300.0, 0.6578), (82200.0, 0.6068), (85100.0, 0.6084), (88000.0, 0.6132), (90900.0, 0.6136), (93800.0, 0.6274), (96700.0, 0.6236), (99600.0, 0.6182), (102500.0, 0.6332), (105400.0, 0.621), (108300.0, 0.5766), (111200.0, 0.6184), (114100.0, 0.618), (117000.0, 0.6016), (119900.0, 0.6198), (122800.0, 0.6116), (125700.0, 0.605), (128600.0, 0.6342), (131500.0, 0.606), (134400.0, 0.6126), (137300.0, 0.6148), (140200.0, 0.5768), (143100.0, 0.637), (146000.0, 0.5912), (148900.0, 0.6064), (151800.0, 0.5728)]
wsbd_adam_8q_3l_r4 = [(0, 0.25),(9700.0, 0.4174), (12600.0, 0.4918), (15500.0, 0.5394), (18400.0, 0.551), (21300.0, 0.5554), (24200.0, 0.626), (27100.0, 0.638), (30000.0, 0.5836), (32900.0, 0.678), (35800.0, 0.6528), (38700.0, 0.6498), (41600.0, 0.6052), (44500.0, 0.656), (47400.0, 0.6502), (50300.0, 0.588), (53200.0, 0.6094), (56100.0, 0.624), (59000.0, 0.6644), (61900.0, 0.665), (64800.0, 0.656), (67700.0, 0.6548), (70600.0, 0.651), (73500.0, 0.66), (76400.0, 0.656), (79300.0, 0.6552), (82200.0, 0.658), (85100.0, 0.6678), (88000.0, 0.6714), (90900.0, 0.6726), (93800.0, 0.663), (96700.0, 0.6456), (99600.0, 0.6674), (102500.0, 0.6638), (105400.0, 0.6428), (108300.0, 0.6748), (111200.0, 0.6424), (114100.0, 0.6488), (117000.0, 0.6402), (119900.0, 0.6342), (122800.0, 0.6302), (125700.0, 0.6204), (128600.0, 0.6314), (131500.0, 0.6326), (134400.0, 0.6326), (137300.0, 0.644), (140200.0, 0.6444), (143100.0, 0.6136), (146000.0, 0.6426), (148900.0, 0.6434), (151800.0, 0.6446)]

wsbd_adam_8q_3l_runs = [wsbd_adam_8q_3l,wsbd_adam_8q_3l_r1, wsbd_adam_8q_3l_r2, wsbd_adam_8q_3l_r3, wsbd_adam_8q_3l_r4]
compute_STD(wsbd_adam_8q_3l_runs, "8Q 3L WSBD ADAM")

adam_8q_3l = [(0, 0.25),(4850, 0.3872), (9700, 0.4174), (14550, 0.5518), (19400, 0.6058), (24250, 0.5868), (29100, 0.5874), (33950, 0.481), (38800, 0.5502), (43650, 0.5394), (48500, 0.525), (53350, 0.5414), (58200, 0.5404), (63050, 0.5358), (67900, 0.5612), (72750, 0.552), (77600, 0.5482), (82450, 0.5738), (87300, 0.6044), (92150, 0.6224), (97000, 0.5838), (101850, 0.5904), (106700, 0.636), (111550, 0.6114), (116400, 0.6014), (121250, 0.6382), (126100, 0.7046), (130950, 0.6286), (135800, 0.6484), (140650, 0.6468), (145500, 0.671)]
adam_8q_3l = [(0, 0.25),(4850, 0.3872), (9700, 0.4174), (14550, 0.5518), (19400, 0.6058), (24250, 0.5868), (29100, 0.5874), (33950, 0.481), (38800, 0.5502), (43650, 0.5394), (48500, 0.525), (53350, 0.5414), (58200, 0.5404), (63050, 0.5358), (67900, 0.5612), (72750, 0.552), (77600, 0.5482), (82450, 0.5738), (87300, 0.6044), (92150, 0.6224), (97000, 0.5838), (101850, 0.5904), (106700, 0.636), (111550, 0.6114), (116400, 0.6014), (121250, 0.6382), (126100, 0.6846), (130950, 0.6286), (135800, 0.6484), (140650, 0.6468), (145500, 0.671)]

sgd_8q_3l = [(0, 0.25),(4850, 0.3106), (9700, 0.3194), (14550, 0.3284), (19400, 0.3312), (24250, 0.3358), (29100, 0.341), (33950, 0.3404), (38800, 0.3424), (43650, 0.3448), (48500, 0.3466), (53350, 0.35), (58200, 0.357), (63050, 0.3826), (67900, 0.3964), (72750, 0.437), (77600, 0.4436), (82450, 0.4652), (87300, 0.4714), (92150, 0.4698), (97000, 0.4824), (101850, 0.4858), (106700, 0.4902), (111550, 0.491), (116400, 0.4902), (121250, 0.4902), (126100, 0.4892), (130950, 0.4888), (135800, 0.4884), (140650, 0.4926), (145500, 0.4912), (150350, 0.4902), (155200, 0.4906), (160050, 0.488), (164900, 0.4894), (169750, 0.49), (174600, 0.4888), (179450, 0.49), (184300, 0.4904), (189150, 0.4936), (194000, 0.4934), (198850, 0.4932), (203700, 0.4938), (208550, 0.4934), (213400, 0.4946), (218250, 0.4942), (223100, 0.4964), (227950, 0.494), (232800, 0.4912), (237650, 0.4932), (242500, 0.4952)]


wsbd_sgd_8q_3l = [(0, 0.25),(9700.0, 0.3194), (12600.0, 0.3294), (15500.0, 0.3344), (18400.0, 0.3382), (21300.0, 0.3378), (24200.0, 0.3382), (27100.0, 0.3408), (30000.0, 0.3424), (32900.0, 0.3434), (35800.0, 0.3492), (38700.0, 0.3732), (41600.0, 0.4258), (44500.0, 0.4452), (47400.0, 0.4588), (50300.0, 0.4706), (53200.0, 0.4748), (56100.0, 0.4774), (59000.0, 0.4772), (61900.0, 0.4802), (64800.0, 0.4786), (67700.0, 0.4752), (70600.0, 0.4772), (73500.0, 0.476), (76400.0, 0.4758), (79300.0, 0.4766), (82200.0, 0.4794), (85100.0, 0.4782), (88000.0, 0.477), (90900.0, 0.476), (93800.0, 0.4774), (96700.0, 0.4802), (99600.0, 0.4814), (102500.0, 0.4852), (105400.0, 0.487), (108300.0, 0.49), (111200.0, 0.4922), (114100.0, 0.4924), (117000.0, 0.4918), (119900.0, 0.4922), (122800.0, 0.4924), (125700.0, 0.4916), (128600.0, 0.495), (131500.0, 0.4978), (134400.0, 0.4984), (137300.0, 0.4988), (140200.0, 0.4988), (143100.0, 0.497), (146000.0, 0.494), (148900.0, 0.4944), (151800.0, 0.4948)]
wsbd_sgd_8q_3l_r1 = [(0, 0.25),(9700.0, 0.3194), (12600.0, 0.3274), (15500.0, 0.3336), (18400.0, 0.3404), (21300.0, 0.3424), (24200.0, 0.3432), (27100.0, 0.3438), (30000.0, 0.346), (32900.0, 0.3486), (35800.0, 0.351), (38700.0, 0.3832), (41600.0, 0.4258), (44500.0, 0.4512), (47400.0, 0.463), (50300.0, 0.4714), (53200.0, 0.469), (56100.0, 0.4658), (59000.0, 0.4624), (61900.0, 0.464), (64800.0, 0.4608), (67700.0, 0.4632), (70600.0, 0.4656), (73500.0, 0.4688), (76400.0, 0.4634), (79300.0, 0.466), (82200.0, 0.4644), (85100.0, 0.4648), (88000.0, 0.4664), (90900.0, 0.4714), (93800.0, 0.4706), (96700.0, 0.4724), (99600.0, 0.4784), (102500.0, 0.4846), (105400.0, 0.4872), (108300.0, 0.4896), (111200.0, 0.491), (114100.0, 0.4928), (117000.0, 0.4932), (119900.0, 0.494), (122800.0, 0.495), (125700.0, 0.4976), (128600.0, 0.5012), (131500.0, 0.5004), (134400.0, 0.502), (137300.0, 0.5046), (140200.0, 0.508), (143100.0, 0.5116), (146000.0, 0.5106), (148900.0, 0.5124), (151800.0, 0.5142)]
wsbd_sgd_8q_3l_r2 = [(0, 0.25),(9700.0, 0.3194), (12600.0, 0.327), (15500.0, 0.3326), (18400.0, 0.3342), (21300.0, 0.3386), (24200.0, 0.3394), (27100.0, 0.341), (30000.0, 0.3416), (32900.0, 0.3462), (35800.0, 0.3572), (38700.0, 0.3902), (41600.0, 0.4342), (44500.0, 0.454), (47400.0, 0.4678), (50300.0, 0.4736), (53200.0, 0.4696), (56100.0, 0.473), (59000.0, 0.472), (61900.0, 0.4712), (64800.0, 0.472), (67700.0, 0.4736), (70600.0, 0.474), (73500.0, 0.4722), (76400.0, 0.4732), (79300.0, 0.479), (82200.0, 0.4784), (85100.0, 0.4806), (88000.0, 0.4802), (90900.0, 0.481), (93800.0, 0.4822), (96700.0, 0.4862), (99600.0, 0.4904), (102500.0, 0.4926), (105400.0, 0.4922), (108300.0, 0.4918), (111200.0, 0.4908), (114100.0, 0.4894), (117000.0, 0.4924), (119900.0, 0.4902), (122800.0, 0.4912), (125700.0, 0.4938), (128600.0, 0.4946), (131500.0, 0.4982), (134400.0, 0.499), (137300.0, 0.4962), (140200.0, 0.4972), (143100.0, 0.4984), (146000.0, 0.4958), (148900.0, 0.4924), (151800.0, 0.4942)]
wsbd_sgd_8q_3l_r3 = [(0, 0.25),(9700.0, 0.3194), (12600.0, 0.3268), (15500.0, 0.3334), (18400.0, 0.3408), (21300.0, 0.3408), (24200.0, 0.3416), (27100.0, 0.3456), (30000.0, 0.3412), (32900.0, 0.3454), (35800.0, 0.35), (38700.0, 0.396), (41600.0, 0.4428), (44500.0, 0.4596), (47400.0, 0.4672), (50300.0, 0.4704), (53200.0, 0.4716), (56100.0, 0.4706), (59000.0, 0.47), (61900.0, 0.473), (64800.0, 0.4726), (67700.0, 0.4738), (70600.0, 0.4762), (73500.0, 0.4752), (76400.0, 0.4722), (79300.0, 0.4748), (82200.0, 0.4754), (85100.0, 0.4748), (88000.0, 0.4762), (90900.0, 0.4756), (93800.0, 0.4772), (96700.0, 0.4838), (99600.0, 0.4866), (102500.0, 0.4922), (105400.0, 0.4922), (108300.0, 0.4922), (111200.0, 0.4934), (114100.0, 0.4932), (117000.0, 0.4952), (119900.0, 0.4932), (122800.0, 0.4956), (125700.0, 0.4996), (128600.0, 0.5026), (131500.0, 0.5034), (134400.0, 0.5032), (137300.0, 0.5028), (140200.0, 0.5042), (143100.0, 0.5018), (146000.0, 0.4994), (148900.0, 0.4982), (151800.0, 0.4978)]
wsbd_sgd_8q_3l_r4 = [(0, 0.25),(9700.0, 0.3194), (12600.0, 0.3258), (15500.0, 0.3332), (18400.0, 0.3422), (21300.0, 0.3424), (24200.0, 0.3422), (27100.0, 0.3422), (30000.0, 0.3382), (32900.0, 0.3326), (35800.0, 0.3322), (38700.0, 0.3336), (41600.0, 0.3762), (44500.0, 0.3948), (47400.0, 0.4308), (50300.0, 0.4432), (53200.0, 0.4464), (56100.0, 0.4578), (59000.0, 0.4622), (61900.0, 0.4624), (64800.0, 0.4614), (67700.0, 0.4618), (70600.0, 0.4602), (73500.0, 0.464), (76400.0, 0.466), (79300.0, 0.4704), (82200.0, 0.469), (85100.0, 0.467), (88000.0, 0.4672), (90900.0, 0.4686), (93800.0, 0.4708), (96700.0, 0.4788), (99600.0, 0.4828), (102500.0, 0.4868), (105400.0, 0.4908), (108300.0, 0.4928), (111200.0, 0.4964), (114100.0, 0.4964), (117000.0, 0.496), (119900.0, 0.4946), (122800.0, 0.4982), (125700.0, 0.5004), (128600.0, 0.5046), (131500.0, 0.5066), (134400.0, 0.508), (137300.0, 0.5064), (140200.0, 0.5056), (143100.0, 0.5046), (146000.0, 0.502), (148900.0, 0.4984), (151800.0, 0.497)]

wsbd_sgd_8q_3l_runs = [wsbd_sgd_8q_3l, wsbd_sgd_8q_3l_r1, wsbd_sgd_8q_3l_r2, wsbd_sgd_8q_3l_r3, wsbd_sgd_8q_3l_r4]
compute_STD(wsbd_sgd_8q_3l_runs, "8Q 3L WSBD SGD")

# 10 qubits 5 layers
adam_10q_5l = [(0, 0.25),(10050, 0.5482), (20100, 0.6388), (30150, 0.62), (40200, 0.66), (50250, 0.6322), (60300, 0.6264), (70350, 0.5738), (80400, 0.6738), (90450, 0.6862), (100500, 0.702), (110550, 0.7296), (120600, 0.7372), (130650, 0.6936)]
#adam_10q_5l=[(10050, 0.5494), (20100, 0.5848), (30150, 0.579), (40200, 0.6028), (50250, 0.6394), (60300, 0.5938), (70350, 0.6156), (80400, 0.5486), (90450, 0.56), (100500, 0.559), (110550, 0.5616), (120600, 0.5808), (130650, 0.5846), (140700, 0.6022), (150750, 0.6128), (160800, 0.6262), (170850, 0.614), (180900, 0.6134), (190950, 0.6248), (201000, 0.6194), (211050, 0.6102), (221100, 0.615), (231150, 0.6136), (241200, 0.6234), (251250, 0.6444), (261300, 0.6486), (271350, 0.6298), (281400, 0.6348), (291450, 0.6332), (301500, 0.6718), (311550, 0.6586), (321600, 0.6528), (331650, 0.6798), (341700, 0.6866), (351750, 0.7268), (361800, 0.6958), (371850, 0.738), (381900, 0.7186), (391950, 0.7356), (402000, 0.7192), (412050, 0.7388), (422100, 0.6676), (432150, 0.7336), (442200, 0.7626), (452250, 0.7632), (462300, 0.7606), (472350, 0.7382), (482400, 0.7328), (492450, 0.7018), (502500, 0.7726)]
wsbd_adam_10q_5l = [(0, 0.25),(20100.0, 0.6388), (26200.0, 0.617), (32300.0, 0.6108), (38400.0, 0.5896), (44500.0, 0.63), (50600.0, 0.6652), (56700.0, 0.671), (62800.0, 0.6594), (68900.0, 0.6702), (75000.0, 0.6628), (81100.0, 0.675), (87200.0, 0.6616), (93300.0, 0.712)]

wsbd_adam_10q_5l = [(0, 0.25),(20100.0, 0.6388), (26200.0, 0.645), (32300.0, 0.65), (38400.0, 0.6366), (44500.0, 0.6508), (50600.0, 0.664), (56700.0, 0.716), (62800.0, 0.7166), (68900.0, 0.7366), (75000.0, 0.7336), (81100.0, 0.7088), (87200.0, 0.7034), (93300.0, 0.7234), (99400.0, 0.7424), (105500.0, 0.7354), (111600.0, 0.7312), (117700.0, 0.7076), (123800.0, 0.716), (129900.0, 0.7062), (136000.0, 0.6962)]
wsbd_adam_10q_5l_r1 =[(0, 0.25),(20100.0, 0.6388), (26200.0, 0.6402), (32300.0, 0.6386), (38400.0, 0.5962), (44500.0, 0.6554), (50600.0, 0.6798), (56700.0, 0.6712), (62800.0, 0.6584), (68900.0, 0.6944), (75000.0, 0.6802), (81100.0, 0.6864), (87200.0, 0.6578), (93300.0, 0.6978), (99400.0, 0.6816), (105500.0, 0.684), (111600.0, 0.7288), (117700.0, 0.7), (123800.0, 0.7272), (129900.0, 0.7092), (136000.0, 0.6906)]
wsbd_adam_10q_5l_r2 = [(0, 0.25),(20100.0, 0.6388), (26200.0, 0.6342), (32300.0, 0.6584), (38400.0, 0.6316), (44500.0, 0.654), (50600.0, 0.6598), (56700.0, 0.6562), (62800.0, 0.6498), (68900.0, 0.684), (75000.0, 0.6538), (81100.0, 0.6782), (87200.0, 0.6528), (93300.0, 0.7098), (99400.0, 0.6994), (105500.0, 0.718), (111600.0, 0.731), (117700.0, 0.6984), (123800.0, 0.7056), (129900.0, 0.7166), (136000.0, 0.7182)]
wsbd_adam_10q_5l_r3 = [(0, 0.25),(20100.0, 0.6388), (26200.0, 0.6584), (32300.0, 0.6074), (38400.0, 0.5946), (44500.0, 0.6384), (50600.0, 0.6784), (56700.0, 0.6928), (62800.0, 0.6784), (68900.0, 0.6976), (75000.0, 0.6686), (81100.0, 0.684), (87200.0, 0.683), (93300.0, 0.6988), (99400.0, 0.687), (105500.0, 0.688), (111600.0, 0.6864), (117700.0, 0.6868), (123800.0, 0.699), (129900.0, 0.688), (136000.0, 0.682)]
wsbd_adam_10q_5l_r4 = [(0, 0.25),(20100.0, 0.6388), (26200.0, 0.6246), (32300.0, 0.6214), (38400.0, 0.6232), (44500.0, 0.6356), (50600.0, 0.687), (56700.0, 0.6754), (62800.0, 0.6792), (68900.0, 0.7076), (75000.0, 0.6816), (81100.0, 0.6952), (87200.0, 0.682), (93300.0, 0.6942), (99400.0, 0.6974), (105500.0, 0.7182), (111600.0, 0.7372), (117700.0, 0.7132), (123800.0, 0.7548), (129900.0, 0.7424), (136000.0, 0.7302)]

wsbd_adam_10q_5l_runs = [wsbd_adam_10q_5l,wsbd_adam_10q_5l_r1, wsbd_adam_10q_5l_r2, wsbd_adam_10q_5l_r3, wsbd_adam_10q_5l_r4]
compute_STD(wsbd_adam_10q_5l_runs, "10Q 5L WSBD ADAM")


#wsbd_adam_10q_5l = [(20100.0, 0.5848), (26200.0, 0.5914), (32300.0, 0.6146), (38400.0, 0.6492), (44500.0, 0.64), (50600.0, 0.6846), (56700.0, 0.6654), (62800.0, 0.6718), (68900.0, 0.6506), (75000.0, 0.6716), (81100.0, 0.6912), (87200.0, 0.6804), (93300.0, 0.6338), (99400.0, 0.6692), (105500.0, 0.6886), (111600.0, 0.688), (117700.0, 0.697), (123800.0, 0.6816), (129900.0, 0.6948), (136000.0, 0.6586), (142100.0, 0.6192), (148200.0, 0.6744), (154300.0, 0.654), (160400.0, 0.6354), (166500.0, 0.6496), (172600.0, 0.6414), (178700.0, 0.6538), (184800.0, 0.6642), (190900.0, 0.6814), (197000.0, 0.6726), (203100.0, 0.7556), (209200.0, 0.7074), (215300.0, 0.726), (221400.0, 0.6958), (227500.0, 0.7512), (233600.0, 0.753), (239700.0, 0.7562), (245800.0, 0.7664), (251900.0, 0.7244), (258000.0, 0.7468), (264100.0, 0.7392), (270200.0, 0.7766), (276300.0, 0.7774), (282400.0, 0.7826), (288500.0, 0.7806), (294600.0, 0.767), (300700.0, 0.7694), (306800.0, 0.6748), (312900.0, 0.729), (319000.0, 0.7266)]
wsbd_sgd_10q_5l = [(0, 0.25),(20100.0, 0.2904), (26200.0, 0.3054), (32300.0, 0.3262), (38400.0, 0.35), (44500.0, 0.3718), (50600.0, 0.3948), (56700.0, 0.4296), (62800.0, 0.4592), (68900.0, 0.4716), (75000.0, 0.4888), (81100.0, 0.5032), (87200.0, 0.5172), (93300.0, 0.5238)]
wsbd_sgd_10q_5l = [(0, 0.25),(20100.0, 0.2904), (26200.0, 0.3062), (32300.0, 0.3296), (38400.0, 0.351), (44500.0, 0.3714), (50600.0, 0.3932), (56700.0, 0.4252), (62800.0, 0.4524), (68900.0, 0.4714), (75000.0, 0.4744), (81100.0, 0.4848), (87200.0, 0.505), (93300.0, 0.518), (99400.0, 0.5302), (105500.0, 0.5384), (111600.0, 0.5412), (117700.0, 0.5472), (123800.0, 0.5518), (129900.0, 0.5512), (136000.0, 0.555), (142100.0, 0.5594), (148200.0, 0.5632), (154300.0, 0.5652), (160400.0, 0.566), (166500.0, 0.5648), (172600.0, 0.5676), (178700.0, 0.5698), (184800.0, 0.5754)]
wsbd_sgd_10q_5l_r1 = [(0, 0.25),(20100.0, 0.2904), (26200.0, 0.3058), (32300.0, 0.333), (38400.0, 0.3554), (44500.0, 0.3874), (50600.0, 0.4196), (56700.0, 0.45), (62800.0, 0.4782), (68900.0, 0.4904), (75000.0, 0.497), (81100.0, 0.5114), (87200.0, 0.5252), (93300.0, 0.5386), (99400.0, 0.5448), (105500.0, 0.55), (111600.0, 0.5576), (117700.0, 0.5582), (123800.0, 0.5594), (129900.0, 0.558), (136000.0, 0.5598), (142100.0, 0.56), (148200.0, 0.561), (154300.0, 0.5622), (160400.0, 0.5584), (166500.0, 0.5566), (172600.0, 0.5562), (178700.0, 0.557), (184800.0, 0.5616)]
wsbd_sgd_10q_5l_r2 = [(0, 0.25),(20100.0, 0.2904), (26200.0, 0.3104), (32300.0, 0.335), (38400.0, 0.3614), (44500.0, 0.3974), (50600.0, 0.426), (56700.0, 0.4634), (62800.0, 0.4854), (68900.0, 0.497), (75000.0, 0.5132), (81100.0, 0.521), (87200.0, 0.5266), (93300.0, 0.5356), (99400.0, 0.5368), (105500.0, 0.539), (111600.0, 0.5462), (117700.0, 0.5454), (123800.0, 0.5506), (129900.0, 0.5522), (136000.0, 0.553), (142100.0, 0.556), (148200.0, 0.555), (154300.0, 0.5492), (160400.0, 0.5438), (166500.0, 0.542), (172600.0, 0.5462), (178700.0, 0.5588), (184800.0, 0.5654)]
wsbd_sgd_10q_5l_r3 = [(0, 0.25),(20100.0, 0.2904), (26200.0, 0.3042), (32300.0, 0.3248), (38400.0, 0.3418), (44500.0, 0.3702), (50600.0, 0.394), (56700.0, 0.4118), (62800.0, 0.4306), (68900.0, 0.439), (75000.0, 0.454), (81100.0, 0.4708), (87200.0, 0.4888), (93300.0, 0.5092), (99400.0, 0.5136), (105500.0, 0.5214), (111600.0, 0.537), (117700.0, 0.5468), (123800.0, 0.547), (129900.0, 0.5518), (136000.0, 0.5496), (142100.0, 0.5526), (148200.0, 0.5554), (154300.0, 0.5562), (160400.0, 0.5554), (166500.0, 0.5586), (172600.0, 0.5584), (178700.0, 0.5628), (184800.0, 0.565)]
wsbd_sgd_10q_5l_r4 = [(0, 0.25),(20100.0, 0.2904), (26200.0, 0.3022), (32300.0, 0.3264), (38400.0, 0.3472), (44500.0, 0.375), (50600.0, 0.406), (56700.0, 0.4436), (62800.0, 0.4718), (68900.0, 0.4994), (75000.0, 0.509), (81100.0, 0.5136), (87200.0, 0.5194), (93300.0, 0.5302), (99400.0, 0.5358), (105500.0, 0.5382), (111600.0, 0.5432), (117700.0, 0.5434), (123800.0, 0.5462), (129900.0, 0.5464), (136000.0, 0.5522), (142100.0, 0.5562), (148200.0, 0.5574), (154300.0, 0.5574), (160400.0, 0.5556), (166500.0, 0.5538), (172600.0, 0.554), (178700.0, 0.5526), (184800.0, 0.5566)]
wsbd_sgd_10q_5l_runs = [wsbd_sgd_10q_5l, wsbd_sgd_10q_5l_r1, wsbd_sgd_10q_5l_r2, wsbd_sgd_10q_5l_r3, wsbd_sgd_10q_5l_r4]

compute_STD(wsbd_sgd_10q_5l_runs, "10Q 5L WSBD SGD")

sgd_10q_5l = [(0, 0.25),(10050, 0.2796), (20100, 0.2904), (30150, 0.3094), (40200, 0.3208), (50250, 0.345), (60300, 0.363), (70350, 0.3842), (80400, 0.4086), (90450, 0.4398), (100500, 0.4622), (110550, 0.4798), (120600, 0.4938), (130650, 0.4974)]
sgd_10q_5l = [(0, 0.25),(10050, 0.2796), (20100, 0.2904), (30150, 0.3094), (40200, 0.3208), (50250, 0.345), (60300, 0.363), (70350, 0.3842), (80400, 0.4086), (90450, 0.4398), (100500, 0.4622), (110550, 0.4798), (120600, 0.4938), (130650, 0.4974), (140700, 0.5116), (150750, 0.5162), (160800, 0.52), (170850, 0.5266), (180900, 0.5366), (190950, 0.543), (201000, 0.5476), (211050, 0.551), (221100, 0.5566), (231150, 0.557), (241200, 0.553), (251250, 0.5562), (261300, 0.5656), (271350, 0.5624), (281400, 0.5624), (291450, 0.5616)]

import matplotlib.pyplot as plt
from matplotlib.ticker import MaxNLocator

fourQ_data = [adam_4q_2l, sgd_4q_2l, wsbd_adam_4q_2l, wsbd_sgd_4q_2l]
eightQ_data = [adam_8q_3l, sgd_8q_3l, wsbd_adam_8q_3l, wsbd_sgd_8q_3l]
tenQ_data = [adam_10q_5l, sgd_10q_5l, wsbd_adam_10q_5l, wsbd_sgd_10q_5l]

labels = ["Adam", "SGD", "WSBD Adam", "WSBD SGD"]
titles = ["4 qubit 2 layers", "8 qubit 3 layers", "10 qubit 5 layers"]
linestyles = ['--', '--', '-', '-']
colors = ['green', 'blue', 'red', 'orange']

fig, axes = plt.subplots(1, 3, figsize=(12, 4))
for ax in axes.ravel():
    ax.set_facecolor("#e2ddddaf")
for ax, dataset, title in zip(axes, [fourQ_data, eightQ_data, tenQ_data], titles):
    for data, label, color, linestyle in zip(dataset, labels, colors, linestyles):
        x = [fp for fp, acc in data]
        y = [acc for fp, acc in data]

        # find index of max accuracy
        max_idx = y.index(max(y))

        # trim x and y up to that point (inclusive)
        x_trimmed = x[:max_idx+1]
        y_trimmed = y[:max_idx+1]

        ax.plot(x_trimmed, y_trimmed, label=f'{label}', linewidth=3, color=color, linestyle=linestyle)
        ax.legend(
            loc='lower right',
            framealpha=1,
            facecolor='white',
            edgecolor='black'
        )
    ax.xaxis.set_major_locator(MaxNLocator(nbins=5, integer=True))
    ax.yaxis.set_major_locator(MaxNLocator(nbins=5, prune=None)) 
    ax.tick_params(axis='both', labelsize=12)
    ax.set_title(title)
    ax.set_xlabel("Forward Passes", fontsize=12)
    ax.set_ylabel("Accuracy", fontsize=12)

plt.tight_layout()
# plt.show()


# for dataset, title in zip([fourQ_data, eightQ_data, tenQ_data], titles):
#     for data, label in zip(dataset, labels):
#         x = [fp for fp, acc in data]
#         y = [acc for fp, acc in data]
#         print(f'{title} {label} Max Accuracy: {max(y):.4f}% {x[y.index(max(y))]}FP')